GIFTIBLY={addToBasket:function(){function e(e,t,n){var i=document.createElement(e);return n&&(i.id=n),t&&(i.className=t),i}function t(){s.style.opacity="0",r.style.opacity="0",n()}function n(){for(var e=document.getElementsByClassName("GFTBmask");e.length>0;)e[0].parentNode.removeChild(e[0])}function i(e){var t=0;e.wheelDelta?t=e.wheelDelta/120:e.detail&&(t=-e.detail/3),(this.scrollTop===this.scrollHeight-this.offsetHeight&&t<0||0===this.scrollTop&&t>0)&&(e.preventDefault&&e.preventDefault(),e.returnValue=!1)}function o(t,n,i){var o=e("div","GFTBconf_image"),a=e("div","GFTBconf_overview"),l=e("h4","conf_details"),r=e("div","GFTBbutton","GFTBnewbasketButton");l.innerHTML=n,h.appendChild(o),h.appendChild(a),o.appendChild(t),a.appendChild(l),a.appendChild(i),r.innerHTML="Create New Gift Basket",a.appendChild(r);for(var s=a.getElementsByClassName("GFTBbutton"),p=0;p<s.length;p++)s[p].addEventListener("click",function(e){console.log(this.id);this.id;c="https://www.giftibly.com/SOMEURLTOHANDLEDATA?";var t="imageUrl="+encodeURIComponent(e),i="&title="+encodeURIComponent(document.title),o="&link="+encodeURIComponent(document.location.href),a="&product_name="+encodeURIComponent(n),l=Math.floor((screen.width-m)/2),r=Math.floor((screen.height-f)/2);c+=t,c+=i,c+=o,c+=a,d(m,f,l,r);this.childNodes[0].childNodes[0];h.innerHTML=""})}function d(e,n,i,o){window.open(c,"GIFTIBLY","status=no,resizable=yes,scrollbars=yes,personalbar=no,directories=no,location=no,toolbar=no,menubar=no,width="+e+",height="+n+",left="+i+",top="+o),t()}n();var a=Math.max(document.body.scrollHeight,document.body.offsetHeight)+"px",l=e("iframe","GFTBmask");l.width="100%",l.height="100%",l.style.height=a;var r=e("div","GFTBmask","GFTBoverlay");r.style.height=a;var s=e("div","GFTBmask","GFTBsavetobasketCnt");s.innerHTML='<div id="GFTBheader"><div id="GFTBclose"></div></div><div id="GFTBproductCnt"></div>',document.body.appendChild(l),document.body.appendChild(r),document.body.appendChild(s),document.getElementById("GFTBclose").addEventListener("click",t),document.addEventListener("keydown",function(e){27==e.keyCode&&t()});var h=s.lastChild;h.addEventListener("DOMMouseScroll",i),h.addEventListener("mousewheel",i);for(var c,p=[],v=200,u=200,m=900,f=480,T=0;T<document.images.length;T++){var g=document.images[T];if(g.src.replace(/\s/g,"")){var B=g.width,y=g.height,C=Math.max(B,y),G=Math.min(B,y);""!==g.src&&C>=100&&C/G<=3&&p.push(g)}}p.length||(n(),alert("Giftibly:\nSorry, there doesn't appear to be any usable images on this page. Please try another.")),p.sort(function(e,t){return t.width*t.height-e.width*e.height});for(var T=0;T<p.length;T++)!function(t,n){var i=e("div","GFTBproductWrapper"),d=document.createElement("img");d.style.opacity="0",d.alt=n,d.onload=function(){var e=this.width,t=this.height;if(e<t)var n=u/t;else var n=u/e;if(e<200&&t<200)var n=1;var i=Math.floor(e*n),o=Math.floor(t*n);this.width=i,this.height=o,this.style.left=Math.floor((v-i)/2)+"px",this.style.top=Math.floor((v-o)/2)+"px",this.style.opacity="1"};var a=e("div","GFTBproduct");a.appendChild(d);var l=e("div","GFTBbutton","GFTBaddButton");l.innerHTML="Add to Gift Basket",a.appendChild(l),i.appendChild(a),h.appendChild(i),i.addEventListener("click",function(){var e=this.childNodes[0].childNodes[0];h.innerHTML="",o(e,n,l)}),d.src=t,(d.width>0||d.height>0)&&(d.onload(),d.onload=null)}(p[T].src,p[T].alt)}},safari.self.addEventListener("message",function(e){window.top===window&&("addToBasket"==e.name?GIFTIBLY.addToBasket():"addCSS"==e.name&&GIFTIBLYSTYLE.loadCSS())},!1);